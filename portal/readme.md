IAM 说明

### 用户登录

#### 规则校验

1. 用户登录时，校验用户是否被锁定，若被锁定，不允许登录
2. 锁定有2种情况，自动解锁和手动解锁，自动解锁剩余时间为`redis`生存时间，手动解锁剩余时间在redis中表现为`ttl=-1`
3. 用户未锁定的情况下，密码错误，`redis`记录该用户在所登录的应用下错误登录的次数。由于用户可能存在多个租户下，因此以登录验证统计周期选择最短，允许错误登录重试次数最多，的规则来判断用户是否应该被锁定。
4. 当错误次数达到最大时，锁定该账户。同时更新`redis`对应的错误记录
5. redis锁定规则如下：

- redis的key为`errorLogin:${appCode}:${loginName}`
- 用户每输错一次，其`value`值加1
- 有效期取决于该用户的租户列表中设置：登录验证统计周期选择最短，允许错误登录重试次数最多，锁定后只要有一个租户中设置为自动解锁，那么redis的有效期为租户的锁定持续时间。否则，需要管理员解锁。
- 手动解锁的状态，redis中的ttl为-1
- 自动解锁的状态，redis中的ttl为租户的持续锁定时间
5. 🙆‍♀

#### 过期规则

1. 用户登录校验完成后，检查该用户所属的租户是否设置强制密码更新
2. 若该租户没有设置密码更新，登录通过
3. 若该租户設有强制更新密码，后端做对应检索

对应有如下四种状态：
```kotlin
enum class PwdExpires(var remark: String) {
    Never("永不过期"),
    Deprecated("已过期"),
    Validity("未过期"),
    Remind("到提醒日"),
}
```

到提醒日时，需要后端返回密码剩余有效期。
